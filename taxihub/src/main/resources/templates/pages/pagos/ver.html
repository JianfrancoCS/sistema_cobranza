<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org"
      th:replace="~{layout/system :: system(~{::content}, ${pageTitle}, ~{::scripts})}">
<head>
    <title th:text="${pageTitle}">Detalle del Pago - TaxiHub</title>
</head>
<body>

<div th:fragment="content" class="d-flex flex-column flex-grow-1">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h2>
            <i class="bi bi-receipt me-2"></i>
            Detalle del Pago #<span th:text="${pago.id}">123</span>
        </h2>
        <div>
            <a th:if="${#authorization.expression('hasRole(''CONDUCTOR'')')}"
               th:href="@{/pagos/conductor}" 
               class="btn btn-outline-secondary">
                <i class="bi bi-arrow-left me-2"></i>Volver a Mis Pagos
            </a>
            <a th:unless="${#authorization.expression('hasRole(''CONDUCTOR'')')}"
               th:href="@{/pagos}" 
               class="btn btn-outline-secondary">
                <i class="bi bi-arrow-left me-2"></i>Volver a Lista de Pagos
            </a>
        </div>
    </div>

    <div class="row g-4">
        <div class="col-lg-6 col-md-12 order-lg-1 order-2">
            <div class="card h-100">
                <div class="card-header">
                    <h5 class="card-title mb-0">
                        <i class="bi bi-image me-2"></i>Voucher de Pago
                    </h5>
                </div>
                <div class="card-body d-flex justify-content-center align-items-center">
                    <div th:if="${pago.imagen != null}" class="text-center">
                        <img th:src="@{'data:' + ${pago.imagenTipo} + ';base64,' + ${pago.imagenBase64}}"
                             alt="Voucher de pago"
                             class="img-fluid rounded shadow-sm"
                             style="max-width: 100%; max-height: 500px; object-fit: contain;">
                    </div>
                    <div th:unless="${pago.imagen != null}" class="text-center text-muted">
                        <i class="bi bi-image-alt fs-1 mb-3"></i>
                        <p>No hay imagen de voucher disponible</p>
                        <small>Este pago no incluye imagen de comprobante</small>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-lg-6 col-md-12 order-lg-2 order-1">
            <div class="card mb-4">
                <div class="card-header">
                    <h5 class="card-title mb-0">
                        <i class="bi bi-info-circle me-2"></i>Información del Pago
                    </h5>
                </div>
                <div class="card-body">
                    <div class="row g-3">
                        <div class="col-12">
                            <label class="form-label fw-bold">ID del Pago:</label>
                            <p class="form-control-plaintext">#<span th:text="${pago.id}">123</span></p>
                        </div>
                        <div class="col-12">
                            <label class="form-label fw-bold">Fecha de Registro:</label>
                            <p class="form-control-plaintext" 
                               th:text="${#temporals.format(pago.fechaCreacion, 'dd/MM/yyyy HH:mm')}">01/01/2024 10:30</p>
                        </div>
                        <div class="col-12">
                            <label class="form-label fw-bold">Modalidad de Pago:</label>
                            <p class="form-control-plaintext" th:text="${pago.modalidadPago}">BILLETERA VIRTUAL</p>
                        </div>
                        <div class="col-12">
                            <label class="form-label fw-bold">Monto Pagado:</label>
                            <p class="form-control-plaintext">
                                <span class="fs-4 fw-bold">
                                    S/ <span th:text="${#numbers.formatDecimal(pago.montoPago, 1, 2)}">150.00</span>
                                </span>
                            </p>
                        </div>
                        <div class="col-12">
                            <label class="form-label fw-bold">Estado:</label>
                            <p class="form-control-plaintext" th:text="${pago.estado}">POR REVISAR</p>
                        </div>
                        <div class="col-12" th:if="${pago.observacion != null and !pago.observacion.isEmpty()}">
                            <label class="form-label fw-bold">Observaciones:</label>
                            <p class="form-control-plaintext" th:text="${pago.observacion}">Observaciones del pago...</p>
                        </div>
                    </div>
                </div>
            </div>

            <div th:if="${deuda != null}" class="card">
                <div class="card-header">
                    <h5 class="card-title mb-0">
                        <i class="bi bi-receipt-cutoff me-2"></i>Deuda que se está Saldando
                    </h5>
                </div>
                <div class="card-body">
                    <div class="row g-3">
                        <div class="col-12">
                            <label class="form-label fw-bold">ID de Deuda:</label>
                            <p class="form-control-plaintext">#<span th:text="${deuda.id}">456</span></p>
                        </div>
                        <div class="col-12">
                            <label class="form-label fw-bold">Monto Total de Deuda:</label>
                            <p class="form-control-plaintext">
                                S/ <span th:text="${#numbers.formatDecimal(deuda.montoDeuda, 1, 2)}">500.00</span>
                            </p>
                        </div>
                        <div class="col-12">
                            <label class="form-label fw-bold">Monto ya Pagado:</label>
                            <p class="form-control-plaintext">
                                S/ <span th:text="${#numbers.formatDecimal(deuda.montoPagado, 1, 2)}">200.00</span>
                            </p>
                        </div>
                        <div class="col-12">
                            <label class="form-label fw-bold">Saldo Pendiente:</label>
                            <p class="form-control-plaintext">
                                S/ <span th:text="${#numbers.formatDecimal(deuda.saldoPendiente, 1, 2)}">300.00</span>
                            </p>
                        </div>
                        <div class="col-12">
                            <label class="form-label fw-bold">Fecha de Deuda:</label>
                            <p class="form-control-plaintext" 
                               th:text="${deuda.fechaCreacion != null ? #temporals.format(deuda.fechaCreacion, 'dd/MM/yyyy') : 'N/A'}">15/12/2023</p>
                        </div>
                        <div class="col-12" th:if="${deuda.empleado?.persona?.nombre != null}">
                            <label class="form-label fw-bold">Conductor:</label>
                            <p class="form-control-plaintext" th:text="${deuda.empleado.persona.nombre}">Juan Pérez</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div th:fragment="scripts">
</div>

</body>
</html>